<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title></title>
<meta name="description" content="">
<meta name="keywords" content="">
<!-- head include -->
<meta name="viewport" content="width=device-width">
<meta name="format-detection" content="telephone=no, email=no, address=no">
</head>
<body>
  <p>sample</p>

  <div class="js-loadNewsXML">
      
  </div>


 <script src="jquery-1.12.3.min.js"></script>
  <script>
  
  $(function(){
    $(function(){
        var $loadXml = $('.js-loadNewsXML');
        if(!$loadXml.length) return;
        console.log('run');

        function unescapeHTML(txt) {
            return $('<div>').html(txt).text();
        };

        function setClsCategory(cat) {
            var catJa = ['その他', '企業情報', 'イベント、キャンペーン', 'コミュニティチャンネル', 'CSR', 'サービス全般', 'TVサービス', 'NETサービス', 'PHONEサービス', 'MOBILEサービス', '電力サービス', 'お知らせ'];
            var catNum = ['cat1', 'cat3', 'cat5', 'cat6', 'cat7', 'cat8', 'cat9', 'cat10', 'cat11', 'cat12', 'cat13', 'cat14'];
            for (var i = 0; i < catJa.length; i++) {
                if(catJa[i] === cat){
                    return catNum[i];
                }
            };
        };

        function setDateYMD(date) {
            var date = date.split(' ');
            var manthEn = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            var manthNum = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];
            var y = date[3];
            var m;
            var d =  date[1];
            for (var i = 0; i < manthEn.length; i++) {
                if(manthEn[i] === date[2]){
                    m = manthNum[i];
                }
            };
            if($loadXml.hasClass('listNewsTy1')){
                return '<span class="y">' + y + '</span><span class="md">/' + m + '/' + d + '</span>'
            }else{
                return '<span class="y">' + y + '</span><span class="md">' + m + '/' + d + '</span>'
            }
        };

        // XML読み込み
        $loadXml.each(function() {
            var $root = $(this);
            var url = '001.xml';
            $.ajax({
                type: 'GET',
                url:  url,
                dataType: 'xml',
                error:function(){
                    console.log("error: XML");
                },
                success: function(xml){
                    // HTMLタグ生成
                    var tag = '';
                    for (var i = 0; i < $(xml).find('item').length; i++) {
                        var $item = $(xml).find('item').eq(i);
                        tag += '<li class="' + setClsCategory($item.find('category').text()) + '"><a href="' + $item.find('link').text() + '">';
                        tag += '<div class="date">' + setDateYMD($item.find('pubDate').text()) + '</div>';
                        tag += '<div class="news"><div class="category"><span class="iconCat"><span>' + $item.find('category').text() + '</span></span></div>';
                        tag += '<div class="info">';
                        tag += '<span class="group">' + $item.find('JCOM_subtitle').text() + '</span>';
                        tag += '<p class="text">' + unescapeHTML($item.find('title').text());
                        if($item.find('JCOM_latest').text() === '1'){
                            tag += '<span class="iconNew">New!</span>';
                        }
                        tag += '</p></div></div></a></li>';
                    }
                    $root.append(tag);
                }
            });
        });

    });
});

  </script>
</body>
</html>